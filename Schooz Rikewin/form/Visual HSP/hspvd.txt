□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□
□                                                                          □
□  HSP Visual Designer ver.0.1.0           Copyright(c) 2003-2011 itow,y.  □
□                                                                          □
□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□

◆はじめに◆

HSP Visual Designer は、HSP の画面レイアウトの設計をビジュアルに行うためのツー
ルです。
このソフト自身も HSP を使って作成されています。

特徴

・オブジェクトの設置個数は無制限です。
・回数無制限のアンドゥ・リドゥが可能です。
・複数のオブジェクトの位置や大きさを簡単に揃えられます。
・色々な変換オプションにより、HSP ソースを好みの形式で出力可能です。
・ローカルクリップボードを使用して、オブジェクトの切り取り・コピー・貼り付けが
  行えます。
・グリッドやルーラーを表示したり、マウス操作をグリッドに合わせることができます。
・ファンクションキーに、任意の機能を割り当てられます。
・HSP の標準命令のみを使用して作成されています。

設置可能なオブジェクト

・ボタン
・入力ボックス
・チェックボックス
・リストボックス
・コンボボックス
・メッセージボックス
・ラジオボタン
・グループボックス
・画像
・メッセージ
・直線
・塗りつぶし矩形
・矩形
・グラデーション矩形
・点

(一応メニューバーとステータスバーも設置できますが、メニューバーは編集するイン
ターフェースができていません)

このファイルには、インストール・アンインストールについての説明と、簡単な使い方
の説明、補足が書かれています。
詳しい使い方や機能の説明は、付属のヘルプを参照してください。


◆動作環境◆

OS : Window 98/2000 以降
対象HSP : ver.2.5〜3.2


◆インストール◆

ファイル構成は以下のようになっています。

・hspvd.exe            実行ファイル
・hspvd.txt            このファイル
・license.txt          ライセンス(GPL)
・rwords261.dat        予約語ファイル(HSP 2.x 用)
・rwords320.dat        予約語ファイル(HSP 3.x 用)
・sample.hfm           フォームのサンプル
・sample2.hfm          サンプルその2
・sample2_main.hsp     サンプルその2の実行部分
・hspvd_0.1.0_src.zip  ソース
・help\                ヘルプファイルが格納されたフォルダ

インストールの際はフォルダを作成し、その中にファイルを展開してください。

実行すると、設定を保存するための hspvd.ini ファイルが、本体と同じフォルダに作成
されます。
その他のフォルダやレジストリなどはいじりませんので、アンインストールの際はファ
イルを削除すればＯＫです。

最初に起動したら、画面上のツールバーの「設定」ボタンを押して、対象となる HSP の
バージョンを指定してください。


◆使い方◆

まずは sample.hfm を開いてみてください。
画面中央にフォームが表示され、画面右にプロパティが表示されます。
フォーム左上にある "Button1" と書かれたボタンを、クリックしてみてください。
そのままドラッグすると、ボタンが移動できます。
ボタンの四隅とその中間にある四角をドラッグすると、ボタンの大きさが変わります。
画面右に表示されているプロパティの中の、「キャプション」と書いてあるところの
"Button1" という文字列を、"OK" に書き換えてみてください。
ボタンの文字列が "OK" になったと思います。

基本的に、以下のような手順でレイアウトを作成します。

1. フォームを新規作成する(フォームのサイズは後で変更できます)。
2. フォーム上にオブジェクトを配置する。
3. オブジェクトのプロパティを設定する。
4. フォームを保存する。
5. HSPソースに変換する。

特に難しい操作はないと思います。ただし、一度はヘルプに目を通しておいてください。
画面下のステータスバーに適宜説明が表示されるので、それを操作の参考にしてくださ
い。

sample2.hfm は、実際に使えるちょっとしたプログラムのサンプルです。
詳しくは sample2_main.hsp を開いて説明を見てください。


◆予約語ファイルについて◆

rwords*.dat ファイルはテキストファイルで、予約語が書かれています。
好きに編集して構いませんが、一行に一つの予約語を、必ず半角小文字で書いてくださ
い。


◆データファイルについて◆

フォームを保存した *.hfm ファイルはテキストファイルですが、読み込みで手を抜いて
いるので適当に変更しないようにしてください。


◆ライセンス◆

・このソフトはフリーソフトウェア(GPL)です。
・著作権は作者に帰属します。
・このソフトの使用及び使用不能によって生じた、いかなる損害も補償しません。


◆更新履歴◆

ver.0.1.0 2011/9/1
  ・最初のリリース


◆余談◆

このプログラムは元々8年程前に作って、中途半端な状態で放置していました。
要望があって公開することになり、どうせなら HSP 3 に移植しようと考えました。
自動で HSP 2.x のコードを 3.x に変換してくれるプログラムもあるみたいなので、
そんなに難しくないだろうと気軽に考えていたのですが…、思った以上に面倒でした。

まず自動変換したのですが、私のコードの書き方が悪いのか、変な所に括弧が付いたり、
文字列がおかしくなったり、文末に謎のゴミ文字列が付いたりと色々おかしくなり、
結局コンパイルを通すだけでも大量の修正が必要になってしまいました。
(HSP のコンパイラは一回コンパイルする毎に一つのエラーしか教えてくれないので、
直してはコンパイル直してはコンパイルの繰り返しが面倒…)

更に、実際に実行してみると次々とエラーが出るので、一つずつ原因を探っては直しと
やっていたのですが、これがまた大変でした。
既に HSP を使わなくなって7年ぐらい経っていたので、コードを見ても意味が分からな
いため、2.x と 3.x のヘルプを見比べつつ修正していきました。

HSP のリファレンスには、命令やパラメータが HSP のどのバージョンから使えるという
ような情報が無いため、バージョン間の違いを調べるのも面倒でした。

現在のところ、まだ色々とできていない部分があるのですが、今後の更新を行うかどう
かは未定です。


◆アドレス◆

Web    : http://www.geocities.jp/iooiau/
E-Mail : iooiau@yahoo.co.jp


[EOF]